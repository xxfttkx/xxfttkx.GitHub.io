---
title: "20250804"
description: 
date: 2025-08-04T08:03:42+08:00
comments: true
draft: false
tags: ["diary"]
---
0150睡到0759，享受早起。

夜里刷到[《Flutter实战·第二版》](https://book.flutterchina.club/chapter6/listview.html)，发现它讲了`itemExtent`，该多看看各个组件的。

有高手做了[星痕共鸣DPS计算](https://github.com/dmlgzs/StarResonanceDamageCounter)，是通过抓包实现的，有点深邃。

DPS计算器很恐怖，社区论坛甚至游戏内部会出现很多清算的人，唉，大家的努力被异化了哈哈。去把[《Flutter实战·第二版》](https://book.flutterchina.club/chapter6/listview.html)先啃一遍再说吧，我基础很薄弱，以前见到`JsBridge`还以为就是为了调用js代码，看了[移动开发技术简介](https://book.flutterchina.club/chapter1/mobile_development_intro.html#_1-1-2-hybrid%E6%8A%80%E6%9C%AF%E7%AE%80%E4%BB%8B)才知道它是为了浏览器和原生之间相互通信。

想看看自己DPS时有类似这个[问题](https://github.com/dmlgzs/StarResonanceDamageCounter/issues/1)，使用[   nvm-windows](https://github.com/coreybutler/nvm-windows/releases)。

[Npcap](https://nmap.org/npcap/) 是一个 Windows 平台上的网络数据包捕获驱动程序，主要用于 **抓取网络流量**，是许多网络分析和安全工具的基础组件。

无法直接通过dart的`Process.start`运行

```
cd F:\Others\StarResonanceDamageCounter
node server.js 4 info
```

会有node版本问题，因为

> **nvm-windows 管理 Node 版本时，是通过修改系统环境变量 PATH 实现的**

```
await Process.start('powershell', ['-Command', 'cd F:\\Others\\StarResonanceDamageCounter; node server.js 4 info']);
```

> 它会用 Dart 默认的环境变量启动 PowerShell，**PATH 中没有你通过 nvm-windows 设置的 Node 路径**，所以 node 找不到，或调用的是旧版本。

一语点醒，我是先启动的flutter应用才下载的`nvm-windows`。然而重启flutter应用不能解决。。果然还是临时变量没能在这里设置到，为什么呢。

试了一下`nvm -v`，这个都报错，很不该的，nvm肯定在全局变量里呀，看来还是该重启flutter应用。

依然不行，怎么回事呢。

powershell里直接`echo $env:PATH`有nvm相关，flutter应用中通过powershell`echo $env:PATH`没有相关变量。随便找了个[diff-text](https://www.diffchecker.com/text-compare/)的网站对比两边的PATH，差的还挺多的，怀疑和用户变量有关。

> 在 Process.start() 中执行的 PowerShell 是非交互式、非登录式的，不会加载用户 profile，也不一定能访问用户级 PATH。

我的nvm在下载的时候自动写进了`系统变量`和`环境变量`。。。所以呢，为什么使用不了。因为它写入的方式是`%NVM_HOME%`吗。

通过flutter的`echo $env:NVM_HOME`无法输出，这也太奇怪了。我要重启IDE。依然不行。我要重启电脑。

果然行了，唉为什么windows这么坏。

> 哈哈，Windows 这环境变量的“刷新”机制确实挺让人头疼的，改了系统变量没重启相关程序甚至重启系统，改动就是没法生效。尤其你这种需要跨多个进程继承环境变量的场景，特别明显。

话说进程启动时是不是都复制了一份环境变量，为什么不用到时再去找。

> 隔离性（Process Isolation）、安全性、效率

你的单一数据来源原则呢。

> 环境变量的复制机制是操作系统层面的“设计决策”，和软件架构中“单一数据来源”的理念侧重点不同，不能简单套用。

nvim的telescope 的find old files不会列出所有打开过的文件，不是很好用，现在每次想打开文件都用livegrep。

> 你说的「最近打开过的文件都识别不到」，这很反常，oldfiles 理论上就是从 Vim/Neovim 维护的历史里读取的，正常来说至少你最近用过的文件都会有。

很奇怪。

find files和live grep区别是什么

> 查找文件名 和 查找文件内容


