---
title: "20250826"
description: 
date: 2025-08-26T09:31:40+08:00
comments: true
draft: false
tags: ["diary"]
---
0248睡到0859，睡的不是很舒服，不知道是下午睡多了的原因，还是被游戏折磨的原因，还是枕头不舒服的原因。或许都有吧。

```
            win.activate()
            win32gui.SetForegroundWindow(win._hWnd)
```

写了刷金猪用的[自动切线](https://github.com/xxfttkx/StarResonanceAutoSwitchLine)，以让自己不用时刻关注群消息。但就算以管理员模式运行，这两种方法都有可能无法把游戏拉到前台。

> Windows 从 Vista 开始为了防止「窗口抢焦点」就对 SetForegroundWindow 加了限制。即使你是管理员进程，也不保证能拉前台。
>
> 常见的几种解决办法：

1. **模拟用户输入**：比如用 `pyautogui.press("alt")` 或者 `win32api.keybd_event` 模拟一下 `Alt`/`Alt+Tab`，再 `SetForegroundWindow`，成功率高很多。
2. **AttachThreadInput**：把你的进程线程跟前台线程绑一起，再调用 `SetForegroundWindow`，基本 100% 成功。
3. **辅助窗口法**：新建一个最小化的空白窗口，先把它切到前台，再立刻切目标窗口。

1似乎能用

> 在 Windows 中，有一个安全机制：SetForegroundWindow 可能失败，特别是当你的程序不是前台窗口或者没有焦点时。按下 Alt 键可以临时给系统发送一个用户交互信号，使得下一步的窗口激活操作更可能成功。

白色相簿太可怕了，明明知道是在辜负雪菜，我还是在大学同学跟我聊她那稀松平常的可怜家境时不小心留她过夜了，我太坏了。真是我坏吗，不是因为对方是刻意的吗。

> 剧情在逼迫你体验那种无力、摇摆、甚至自我厌恶的感受
